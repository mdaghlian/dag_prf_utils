#!/usr/bin/env python
#$ -j Y
#$ -cwd
#$ -V


import numpy as np  
import matplotlib.pyplot as plt
import matplotlib as mpl
from datetime import datetime
import os
from scipy.spatial import ConvexHull
import subprocess
opj = os.path.join

from io import BytesIO
import base64
from dag_prf_utils.utils import *
from dag_prf_utils.plot_functions import *
from dag_prf_utils.mesh_format import *
from dag_prf_utils.fs_tools import *
try:
    import plotly.graph_objects as go
except:
    print('No plotly')

try: 
    from dash import Dash, dcc, html, Input, Output, State
    import dash
    from flask import Flask, send_file,render_template_string, send_from_directory
except:
    print('no dash..')

path_to_utils = os.path.abspath(os.path.dirname(__file__))

import pickle
def main(argv):
    '''
    ---------------------------
    Open the freesurfer surfaces for a subject

    Args:
        path        path to pickle file


    '''
    # Load the fitting settings, add in the new info
    # [1] Setup parameters:
    pickle_file_path = argv[0]
    # Loading the variable from the pickle file
    with open(pickle_file_path, 'rb') as f:
        loaded_fs = pickle.load(f)
    app = loaded_fs.web_launch_with_dash()
    # Open the app in a browser
    # Do not show it in the notebook
    print(f'http://localhost:8000/')
    app.run_server(mode='external', host='127.0.0.1', port=8000, debug=False, use_reloader=False) 



if __name__ == "__main__":
    main(sys.argv[1:])    